<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ menu.name }}</title>
    <style>
        @page {
            margin: 10mm;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: DejaVu Sans, sans-serif;
            font-size: 9px;
            line-height: 1.3;
            margin: 0;
            padding: 0;
        }

        .header {
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #333;
        }

        .header h1 {
            margin: 0 0 5px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .header .dates {
            font-size: 12px;
            color: #555;
        }

        .menu-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .menu-table th,
        .menu-table td {
            border: 1px solid #ccc;
            padding: 4px;
            vertical-align: top;
        }

        .menu-table th {
            background-color: #2563eb;
            color: white;
            font-weight: bold;
            text-align: center;
            font-size: 11px;
            padding: 8px 4px;
        }

        .menu-table th .date {
            font-size: 9px;
            font-weight: normal;
            opacity: 0.9;
        }

        .day-column {
            width: 14.28%;
        }

        .meal-type-section {
            margin-bottom: 6px;
            padding: 4px;
            border-radius: 3px;
        }

        .meal-type-section:last-child {
            margin-bottom: 0;
        }

        .meal-type-header {
            font-weight: bold;
            font-size: 10px;
            margin-bottom: 4px;
            padding: 3px 5px;
            border-radius: 2px;
        }

        .meal-type-breakfast { background-color: #FEF3C7; }
        .meal-type-lunch { background-color: #DBEAFE; }
        .meal-type-snack { background-color: #D1FAE5; }
        .meal-type-dinner { background-color: #EDE9FE; }
        .meal-type-late_dinner { background-color: #F3F4F6; }

        .course {
            margin-bottom: 4px;
            padding-left: 4px;
        }

        .course:last-child {
            margin-bottom: 0;
        }

        .course-label {
            font-size: 8px;
            color: #666;
            font-style: italic;
        }

        .variant {
            margin: 2px 0;
            padding-left: 4px;
        }

        .variant-name {
            font-weight: bold;
            font-size: 8px;
            color: #333;
        }

        .meal-item {
            display: block;
            font-size: 8px;
            padding: 1px 0;
        }

        .meal-name {
            color: #111;
        }

        .diet-codes {
            color: #666;
            font-size: 7px;
        }

        .empty-cell {
            color: #999;
            font-style: italic;
            text-align: center;
            padding: 10px;
        }

        .footer {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid #ccc;
            font-size: 8px;
            color: #666;
        }

        .footer-row {
            display: table;
            width: 100%;
        }

        .footer-left {
            display: table-cell;
            text-align: left;
        }

        .footer-right {
            display: table-cell;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>{{ menu.name }}</h1>
        <div class="dates">
            Platnost: {{ menu.validFrom|date('d.m.Y') }} - {{ menu.validTo|date('d.m.Y') }}
        </div>
    </div>

    <table class="menu-table">
        <thead>
            <tr>
                {% for day in menu.days %}
                    <th class="day-column">
                        {{ day.dayLabel }}
                        {% if day.date %}
                            <div class="date">{{ day.date|date('d.m.') }}</div>
                        {% endif %}
                    </th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            <tr>
                {% for day in menu.days %}
                    <td>
                        {% if day.mealTypes|length > 0 %}
                            {% for mealType in day.mealTypes %}
                                <div class="meal-type-section">
                                    <div class="meal-type-header meal-type-{{ mealType.mealType.value }}">
                                        {{ mealType.mealType.label }}
                                    </div>
                                    {% if mealType.courses|length > 0 %}
                                        {% for course in mealType.courses %}
                                            <div class="course">
                                                {% if mealType.courses|length > 1 %}
                                                    <span class="course-label">Chod {{ loop.index }}:</span>
                                                {% endif %}
                                                {% for variant in course.variants %}
                                                    <div class="variant">
                                                        {% if variant.name %}
                                                            <span class="variant-name">{{ variant.name }}:</span>
                                                        {% elseif course.variants|length > 1 %}
                                                            <span class="variant-name">V{{ loop.index }}:</span>
                                                        {% endif %}
                                                        {% for variantMeal in variant.meals %}
                                                            <span class="meal-item">
                                                                <span class="meal-name">{{ variantMeal.meal.name }}</span>
                                                                {% if variantMeal.meal.diet %}
                                                                    <span class="diet-codes">({{ variantMeal.meal.diet.codesLabel }})</span>
                                                                {% endif %}
                                                            </span>
                                                        {% endfor %}
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-cell">-</div>
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
        </tbody>
    </table>

    <div class="footer">
        <div class="footer-row">
            <div class="footer-left">
                {% if menu.createdBy %}Vytvořil: {{ menu.createdBy }}{% endif %}
                {% if menu.createdBy and menu.approvedBy %} | {% endif %}
                {% if menu.approvedBy %}Schválil: {{ menu.approvedBy }}{% endif %}
            </div>
            <div class="footer-right">
                Vygenerováno: {{ "now"|date('d.m.Y H:i') }}
            </div>
        </div>
    </div>
</body>
</html>
